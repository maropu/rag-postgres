<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>68.4. 実装</title><link rel="stylesheet" type="text/css" href="stylesheet.css" /><link rev="made" href="pgsql-docs@lists.postgresql.org" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="prev" href="gist-extensibility.html" title="68.3. 拡張性" /><link rel="next" href="gist-examples.html" title="68.5. 例" /><meta name="viewport" content="width=device-width,initial-scale=1.0" /><style type="text/css"><!--
h1.TITLE {clear:both;}
.versions {
  float:right;
  margin-top:-0.2em;
  margin-bottom:0.5em;
  width: auto;
  padding:0.4em 1em;
  border:solid 1px #e0e0e0;
  border-radius:0.5em;
  background:#f3f3f3;
  background-image:-webkit-linear-gradient(#fbfbfb, #ebebeb);
  background-image:-moz-linear-gradient(#fbfbfb, #ebebeb);
  background-image:-o-linear-gradient(#fbfbfb, #ebebeb);
  background-image:linear-gradient(#fbfbfb, #ebebeb);
  box-shadow:0 3px 8px -3px #000;
}
.versions .label {
  cursor:pointer;
}
.versions .label:hover {
  text-decoration:underline;
}
.versions .list {
  display:none;
}
.versions .list-toggle {
  display:inline;
}
.versions .me {
  padding:0 0.2em;
  border:solid 2px #e88;
  border-radius:0.3em;
  background:#fbfbfb;
  font-weight:bold;
}
.versions .other {
  font-weight:bold;
}
.versions .unsup {
  color:#aaa;
}
.versions .unsup a {
  color:#aaa;
}

@media print {
  a {
    color: inherit;
    text-decoration: none;
  }
  a:visited {
    color: inherit;
  }
  .NAVHEADER, .versions, .NAVFOOTER {
    display: none;
  }
}
--></style><script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
<script type="text/javascript"><!--
  $(function(){
      $(".versions .label").bind("click", function(){
          $(".versions .list").toggleClass("list-toggle");
      })
  });
--></script></head><body id="docContent" class="container-fluid col-10"><div class="versions"><span class="label">他のバージョンの文書</span> <span class="list">： <span class="me">15</span> | <span class="other"><a href="/document/14/html/gist-implementation.html">14</a><span> | <span class="other"><a href="/document/13/html/gist-implementation.html">13</a><span> | <span class="other"><a href="/document/12/html/gist-implementation.html">12</a><span> | <span class="other"><a href="/document/11/html/gist-implementation.html">11</a><span> | <span class="other"><a href="/document/10/html/gist-implementation.html">10</a><span> | <span class="other"><a href="/document/9.6/html/gist-implementation.html">9.6</a><span> | <span class="other"><a href="/document/9.5/html/gist-implementation.html">9.5</a><span> | <span class="other"><a href="/document/9.4/html/gist-implementation.html">9.4</a><span> | <span class="other"><a href="/document/9.3/html/gist-implementation.html">9.3</a><span> | <span class="other"><a href="/document/9.2/html/gist-implementation.html">9.2</a><span> | <span class="unsup"><a href="/document/9.1/index.html">9.1</a></span> | <span class="unsup"><a href="/document/9.0/index.html">9.0</a></span> | <span class="unsup"><a href="/document/8.4/index.html">8.4</a></span> | <span class="unsup"><a href="/document/8.3/index.html">8.3</a></span> | <span class="other"><a href="/document/8.2/html/gist-implementation.html">8.2</a><span> | <span class="other"><a href="/document/8.1/html/gist-implementation.html">8.1</a><span> | <span class="unsup"><a href="/document/8.0/index.html">8.0</a></span> | <span class="unsup"><a href="/document/7.4/index.html">7.4</a></span> | <span class="unsup"><a href="/document/7.3/index.html">7.3</a></span> | <span class="unsup"><a href="/document/7.2/index.html">7.2</a></span></span></div><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="4" align="center"><a accesskey="h" href="index.html">PostgreSQL 15.4文書</a></th></tr><tr><td width="10%" align="left"></td><td width="10%" align="left"></td><td width="60%" align="center"><a href="gist.html" title="第68章 GiSTインデックス">第68章 GiSTインデックス</a></td><td width="20%" align="right"></td></tr><tr><td width="10%" align="left"><a accesskey="p" href="gist-extensibility.html" title="68.3. 拡張性">前へ</a> </td><td width="10%" align="left"><a accesskey="u" href="gist.html" title="第68章 GiSTインデックス">上へ</a></td><td width="60%" align="center">68.4. 実装</td><td width="20%" align="right"> <a accesskey="n" href="gist-examples.html" title="68.5. 例">次へ</a></td></tr></table><hr /></div><div class="sect1" id="GIST-IMPLEMENTATION"><div class="titlepage"><div><div><h2 class="title" style="clear: both">68.4. 実装</h2></div></div></div><!--
 <title>Implementation</title>
--><div class="sect2" id="GIST-BUFFERING-BUILD"><div class="titlepage"><div><div><h3 class="title">68.4.1. GiSTインデックス構築法</h3></div></div></div><!--
  <title>GiST Index Build Methods</title>
--><p>
<!--
   The simplest way to build a GiST index is just to insert all the entries,
   one by one.  This tends to be slow for large indexes, because if the
   index tuples are scattered across the index and the index is large enough
   to not fit in cache, a lot of random I/O will be
   needed.  <productname>PostgreSQL</productname> supports two alternative
   methods for initial build of a GiST index: <firstterm>sorted</firstterm>
   and <firstterm>buffered</firstterm> modes.
-->
GiSTインデックスを構築する一番簡単な方法は、全項目を単に1つ1つ挿入することです。
インデックスタプルがインデックス全体に分散し、インデックスがキャッシュに収まらない程大規模である場合、大量のランダムI/Oを必要としますので、これは大規模なインデックスに対して低速になりがちです。
<span class="productname">PostgreSQL</span>はGiSTインデックスの初期構築のために他に2つの方法をサポートします。<em class="firstterm">ソート処理</em>モードと<em class="firstterm">バッファ処理</em>モードです。
  </p><p>
<!--
   The sorted method is only available if each of the opclasses used by the
   index provides a <function>sortsupport</function> function, as described
   in <xref linkend="gist-extensibility"/>.  If they do, this method is
   usually the best, so it is used by default.
-->
ソート処理法は、インデックスで使われる演算子クラスのそれぞれが、<a class="xref" href="gist-extensibility.html" title="68.3. 拡張性">68.3</a>に記載されているように<code class="function">sortsupport</code>を提供している場合にのみ利用可能です。
もしそうであれば、この方法が普通は最善ですので、デフォルトで使われます。
  </p><p>
<!--
   The buffered method works by not inserting tuples directly into the index
   right away.  It can dramatically reduce the amount of random I/O needed
   for non-ordered data sets.  For well-ordered data sets the benefit is
   smaller or non-existent, because only a small number of pages receive new
   tuples at a time, and those pages fit in cache even if the index as a
   whole does not.
-->
バッファ処理法はタプルを直ちに直接インデックスに挿入しないことで動作します。
これは、順序付けられていないデータ群に対して必要とされるランダムI/Oの量を劇的に減らすかもしれません。
十分に順序付けられたデータ群では、一度にわずかなページ数のみが新しいタプルを受け取り、そのためインデックス全体がキャッシュに収まらなくてもこれらのページがキャッシュ内に収まりますので、利点はより小さく、または利点がなくなります。
  </p><p>
<!--
   The buffered method needs to call the <function>penalty</function>
   function more often than the simple method does, which consumes some
   extra CPU resources. Also, the buffers need temporary disk space, up to
   the size of the resulting index. Buffering can also influence the quality
   of the resulting index, in both positive and negative directions. That
   influence depends on various factors, like the distribution of the input
   data and the operator class implementation.
-->
バッファ処理法は、<code class="function">penalty</code>関数を単純な方法よりもより多く呼び出すことが必要で、余計にCPUリソースを消費します。
またバッファは、最大作成されるインデックスと同じサイズまで、一時的にディスク容量を必要とします。
バッファ処理は作成されるインデックスの品質にも、良くも悪くも、影響を与えます。
この影響は、入力データの分布や演算子クラスの実装等、様々な要因に依存します。
  </p><p>
<!--
   If sorting is not possible, then by default a GiST index build switches
   to the buffering method when the index size reaches
   <xref linkend="guc-effective-cache-size"/>.  Buffering can be manually
   forced or prevented by the <literal>buffering</literal> parameter to the
   CREATE INDEX command.  The default behavior is good for most cases, but
   turning buffering off might speed up the build somewhat if the input data
   is ordered.
-->
ソートが可能でない場合、デフォルトでは、インデックスのサイズが<a class="xref" href="runtime-config-query.html#GUC-EFFECTIVE-CACHE-SIZE">effective_cache_size</a>に達した時にGiSTインデックス構築はバッファ処理法に切り替わります。
バッファ処理はCREATE INDEXコマンドの<code class="literal">buffering</code>パラメータによって、手動で強制あるいは無効にできます。
デフォルトの動作は大抵の場合良好です。
しかし、入力データが順序付けされている場合、バッファ処理を無効にすることで構築が多少高速になります。
  </p></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="gist-extensibility.html" title="68.3. 拡張性">前へ</a> </td><td width="20%" align="center"><a accesskey="u" href="gist.html" title="第68章 GiSTインデックス">上へ</a></td><td width="40%" align="right"> <a accesskey="n" href="gist-examples.html" title="68.5. 例">次へ</a></td></tr><tr><td width="40%" align="left" valign="top">68.3. 拡張性 </td><td width="20%" align="center"><a accesskey="h" href="index.html" title="PostgreSQL 15.4文書">ホーム</a></td><td width="40%" align="right" valign="top"> 68.5. 例</td></tr></table></div></body></html>